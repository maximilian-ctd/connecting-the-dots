---
import { getTranslations, type Language } from '../i18n/translations';

interface Props {
  lang?: Language;
}

const { lang = 'de' } = Astro.props;
const t = getTranslations(lang);
---

<section class="bg-gradient-to-br from-white via-secondary/30 to-white py-6 overflow-hidden">
  <div class="max-w-7xl mx-auto px-4">
    <div 
      id="customer-header"
      class="text-center mb-8 opacity-0"
    >
      <p class="text-sm text-muted-foreground">
        {t.customerReferences.title}
      </p>
    </div>
    
    <div class="relative">
      <div 
        id="customer-scroll"
        class="flex gap-8"
      >
        <!-- Erste Reihe Logos -->
        <div class="flex gap-8 flex-shrink-0">
          <div class="logo-card">
            <img 
              src="/images/b98556db3c843164bbb3a774ce55b5998de2f009.png" 
              alt="Brillen.de Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/7a9b772364c890df4c839614fcf75a603c689245.png" 
              alt="MyPostcard Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/0868420e2592f1a8944649400632588296d3c22b.png" 
              alt="Vista Point Verlag Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/280197cc4f34417bd05646dffc7f56e6f8a15317.png" 
              alt="theGenesys.ai Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/8b1fe9a88cb76ecfb2bd075f1fd259a1ead00078.png" 
              alt="TheList.app Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/41144ac6829b4b8ce105a021e42e2c7135c8ab45.png" 
              alt="TourCont Logo"
              class="logo-img"
            />
          </div>
        </div>
        
        <!-- Zweite Reihe Logos (Duplikat für seamless scroll) -->
        <div class="flex gap-8 flex-shrink-0">
          <div class="logo-card">
            <img 
              src="/images/b98556db3c843164bbb3a774ce55b5998de2f009.png" 
              alt="Brillen.de Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/7a9b772364c890df4c839614fcf75a603c689245.png" 
              alt="MyPostcard Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/0868420e2592f1a8944649400632588296d3c22b.png" 
              alt="Vista Point Verlag Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/280197cc4f34417bd05646dffc7f56e6f8a15317.png" 
              alt="theGenesys.ai Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/8b1fe9a88cb76ecfb2bd075f1fd259a1ead00078.png" 
              alt="TheList.app Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-card">
            <img 
              src="/images/41144ac6829b4b8ce105a021e42e2c7135c8ab45.png" 
              alt="TourCont Logo"
              class="logo-img"
            />
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  function initCustomerReferences() {
    // Stelle sicher, dass no-js entfernt wurde
    document.documentElement.classList.remove('no-js');
    
    const header = document.getElementById('customer-header');
    const scrollContainer = document.getElementById('customer-scroll');
    
    if (!header || !scrollContainer) return;

    // Fade in header
    setTimeout(() => {
      header.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
      header.style.opacity = '1';
      header.style.transform = 'translateY(0)';
    }, 100);

    // Infinite scroll animation
    let scrollPosition = 0;
    const scrollSpeed = 0.5; // pixels per frame
    const cardWidth = 180;
    const gap = 32;
    const totalWidth = (cardWidth + gap) * 6; // 6 items per set

    function animateScroll() {
      scrollPosition -= scrollSpeed;
      
      // Reset position when we've scrolled one full set
      if (Math.abs(scrollPosition) >= totalWidth) {
        scrollPosition = 0;
      }
      
      scrollContainer.style.transform = `translateX(${scrollPosition}px)`;
      requestAnimationFrame(animateScroll);
    }

    // Start animation
    animateScroll();
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCustomerReferences);
  } else {
    initCustomerReferences();
  }
</script>

<style>
  #customer-header {
    transform: translateY(20px);
  }

  #customer-scroll {
    will-change: transform;
  }

  .logo-card {
    width: 180px;
    height: 110px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(123, 224, 183, 0.2);
    border-radius: 1.25rem;
    padding: 1.25rem;
    box-shadow: 0 15px 35px -20px rgba(15, 23, 42, 0.35);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .logo-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 20px 45px -18px rgba(123, 224, 183, 0.45);
  }

  .logo-img {
    max-width: 100%;
    max-height: 70px;
    object-fit: contain;
    filter: grayscale(0.1);
    opacity: 0.85;
    transition: opacity 0.3s ease, filter 0.3s ease;
  }

  .logo-card:hover .logo-img {
    opacity: 1;
    filter: grayscale(0);
  }

  /* Fallback: Wenn JavaScript nicht läuft, zeige Content trotzdem */
  .no-js #customer-header {
    opacity: 1 !important;
    transform: none !important;
  }
</style>


